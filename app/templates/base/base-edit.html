{% extends "base/base-page.html" %}

{% block content %}
<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h3>{{ title }}</h3>
    <div>
      <a href="{{ url_for(request.endpoint.rsplit('.', 1)[0] + '.view', item_id=item.id) }}" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Cancel
      </a>
    </div>
  </div>
  <div class="card-body">
    <form method="POST" action="{{ submit_url }}">
      <div class="row">
        {% for field in fields %}
        <div class="col-md-6 mb-3">
          <div class="card">
            <div class="card-header">
              <strong>{{ field.label }}</strong>
              {% if field.required %}
              <span class="text-danger">*</span>
              {% endif %}
            </div>
            <div class="card-body">
              {% if field.type == 'text' %}
              <input type="text" class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                     value="{{ field.value|default('') }}" {% if field.required %}required{% endif %}>

              {% elif field.type == 'textarea' %}
              <textarea class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                        rows="3" {% if field.required %}required{% endif %}>{{ field.value|default('') }}</textarea>

              {% elif field.type == 'number' %}
              <input type="number" class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                     value="{{ field.value|default('') }}" {% if field.required %}required{% endif %}
                     {% if field.min is defined %}min="{{ field.min }}"{% endif %}
                     {% if field.max is defined %}max="{{ field.max }}"{% endif %}
                     {% if field.step is defined %}step="{{ field.step }}"{% endif %}>

              {% elif field.type == 'date' %}
              <input type="date" class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                     value="{{ field.value|default('') }}" {% if field.required %}required{% endif %}>

              {% elif field.type == 'datetime-local' %}
              <input type="datetime-local" class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                     value="{{ field.value|default('') }}" {% if field.required %}required{% endif %}>

              {% elif field.type == 'select' %}
              <select class="form-select" id="{{ field.name }}" name="{{ field.name }}" {% if field.required %}required{% endif %}>
                <option value="">-- Select {{ field.label }} --</option>
                {% for option in field.options %}
                <option value="{{ option.value }}" {% if option.value == field.value %}selected{% endif %}>
                  {{ option.label }}
                </option>
                {% endfor %}
              </select>

              {% elif field.type == 'checkbox' %}
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="{{ field.name }}" name="{{ field.name }}"
                       value="true" {% if field.value %}checked{% endif %}>
                <label class="form-check-label" for="{{ field.name }}">
                  {{ field.description|default('Enable') }}
                </label>
              </div>

              {% elif field.type == 'radio' %}
              {% for option in field.options %}
              <div class="form-check">
                <input class="form-check-input" type="radio" id="{{ field.name }}_{{ loop.index }}"
                       name="{{ field.name }}" value="{{ option.value }}"
                       {% if option.value == field.value %}checked{% endif %}
                       {% if field.required %}required{% endif %}>
                <label class="form-check-label" for="{{ field.name }}_{{ loop.index }}">
                  {{ option.label }}
                </label>
              </div>
              {% endfor %}

              {% else %}
              <input type="text" class="form-control" id="{{ field.name }}" name="{{ field.name }}"
                     value="{{ field.value|default('') }}" {% if field.required %}required{% endif %}>
              {% endif %}

              {% if field.help_text %}
              <div class="form-text text-muted mt-1">{{ field.help_text }}</div>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <div class="mt-4 d-flex justify-content-between">
        <a href="{{ cancel_url }}" class="btn btn-secondary">
          Cancel
        </a>
        <button type="submit" class="btn btn-primary">
          {{ button_text|default('Save Changes') }}
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}