{% extends "layouts/base.html" %}
{% import "macros/cards.html" as cards %}
{% import "macros/recent_activity.html" as recent_activity %}
{% import "macros/sections.html" as sections %}

{% block title %}CRM Dashboard - Home{% endblock %}

{% block content %}
<!-- Heading & subtext section -->
{{ sections.heading_section(
  heading_text='Welcome to your CRM',
  subtext='Manage your customer relationships efficiently'
) }}

<!-- Large Cards: Data -->
{% set large_card_data = [
  {
    "icon": "bi bi-building",
    "color": "text-primary",
    "title": "Companies",
    "description": "Manage all your client companies",
    "url": "/companies"
  },
  {
    "icon": "bi bi-people",
    "color": "text-success",
    "title": "Customers",
    "description": "Manage individual customer contacts",
    "url": "/customers"
  },
  {
    "icon": "bi bi-graph-up-arrow",
    "color": "text-danger",
    "title": "Opportunities",
    "description": "Track sales opportunities and deals",
    "url": "/opportunities"
  }
] %}

<!-- Large Cards: HTML  -->
{{ sections.large_cards_section(large_card_data) }}

<!-- Summary Section: Data -->
{% set stats_data = [
  {"value": "4", "label": "Companies", "color": "text-primary"},
  {"value": "9", "label": "Contacts", "color": "text-success"},
  {"value": "7", "label": "Deals", "color": "text-danger"},
  {"value": "$925K", "label": "Pipeline", "color": "text-info"}
] %}

{% set highlights_data = [
  {
    "icon": "fas fa-project-diagram",
    "icon_color": "text-primary",
    "message": "<strong>4</strong> companies · <strong>9</strong> contacts · <strong>7</strong> deals = <strong>$925K</strong> pipeline",
  },
  {
    "icon": "fas fa-arrow-up",
    "icon_color": "text-success",
    "message": "<strong>$125K</strong> added to pipeline this week",
  },
  {
    "icon": "fas fa-chart-line",
    "icon_color": "text-primary",
    "message": "<strong>3</strong> deals progressed to next stage",
  },
  {
    "icon": "fas fa-percentage",
    "icon_color": "text-warning",
    "message": "CRIP score increased by <strong>12%</strong> this month",
  },
  {
    "icon": "fas fa-trophy",
    "bg_color": "text-danger",
    "message": "<strong>2</strong> net new logos added this quarter",
  }
] %}

{{ sections.highlights_section(stats_data, highlights_data) }}

<!-- Recent Activity Section -->
{% set recent_activities = [
  {
    "icon": "bi bi-graph-up",
    "bg_color": "bg-warning",
    "message": "Deal progressed: <strong>GlobalTech - Moved to Negotiation</strong>",
    "time": "1 hour ago"
  },
  {
    "icon": "bi bi-person-plus",
    "bg_color": "bg-primary",
    "message": "New contact added: <strong>Sarah Johnson</strong>",
    "time": "3 hours ago"
  },
  {
    "icon": "bi bi-building-add",
    "bg_color": "bg-danger",
    "message": "New company added: <strong>Quantum Solutions</strong>",
    "time": "Yesterday"
  },
  {
    "icon": "bi bi-currency-dollar",
    "bg_color": "bg-success",
    "message": "Deal closed: <strong>Fusion Industries - $185,000</strong>",
    "time": "2 days ago"
  },
  {
    "icon": "bi bi-calendar-event",
    "bg_color": "bg-info",
    "message": "Meeting scheduled with <strong>NexGen Systems</strong>",
    "time": "March 27, 2025"
  }
] %}

{# Use the recent_activity widget with your activities #}
{{ recent_activity.recent_activity(recent_activities, "Recent Activity", "/all-activities") }}
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/components/highlights.js') }}"></script>
{% endblock %}

{% block head_extra %}
<style>
  .activity-icon {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>
{% endblock %}