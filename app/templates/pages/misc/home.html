{% extends "layouts/base.html" %}
{% import "macros/navigation_cards.html" as navigation_cards %}
{% import "macros/highlights.html" as highlights %}
{% import "macros/recent_activity.html" as recent_activity %}

{% block title %}CRM Dashboard - Home{% endblock %}

{% block content %}
<!-- Welcome Section -->
<div class="row mb-4">
  <div class="col-12">
    <div class="bg-white p-4 rounded shadow-sm">
      <h1 class="page-heading">Welcome to your CRM</h1>
      <p class="page-heading-subtext">Manage your customer relationships efficiently</p>
    </div>
  </div>
</div>

<div class="row mb-4">
<!-- Navigation Cards -->
  {{ navigation_cards.navigation_card(
    "bi bi-building", "text-primary",
    "Companies", "Manage all your client companies",
    "/companies"
  ) }}

  {{ navigation_cards.navigation_card(
    "bi bi-people", "text-success",
    "Customers", "Manage individual customer contacts",
    "/customers"
  ) }}

  {{ navigation_cards.navigation_card(
    "bi bi-graph-up-arrow", "text-danger",
    "Opportunities", "Track sales opportunities and deals",
    "/opportunities"
  ) }}
</div>

<!-- Summary Section -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-white">
        <h2 class="section-card-heading">Summary</h2>
      </div>
      <div class="card-body">
        <div class="row">
          {{ navigation_cards.stat_card("4", "Companies", "text-primary") }}
          {{ navigation_cards.stat_card("9", "Contacts", "text-success") }}
          {{ navigation_cards.stat_card("7", "Deals", "text-danger") }}
          {{ navigation_cards.stat_card("$925K", "Pipeline", "text-info") }}
        </div>

        {% set highlights_data = [
          {
            "icon": "bi bi-diagram-3",
            "bg_color": "bg-primary",
            "message": "<strong>4</strong> companies · <strong>9</strong> contacts · <strong>7</strong> deals = <strong>$925K</strong> pipeline",
            "time": "Current"
          },
          {
            "icon": "bi bi-arrow-up",
            "bg_color": "bg-success",
            "message": "<strong>$125K</strong> added to pipeline this week",
            "time": "This week"
          },
          {
            "icon": "bi bi-graph-up",
            "bg_color": "bg-primary",
            "message": "<strong>3</strong> deals progressed to next stage",
            "time": "This week"
          },
          {
            "icon": "bi bi-percent",
            "bg_color": "bg-warning",
            "message": "CRIP score increased by <strong>12%</strong> this month",
            "time": "This month"
          },
          {
            "icon": "bi bi-trophy",
            "bg_color": "bg-danger",
            "message": "<strong>2</strong> net new logos added this quarter",
            "time": "This quarter"
          }
        ] %}

        {{ highlights.highlights(highlights_data) }}

      </div>
    </div>
  </div>
</div>

<!-- Recent Activity Section -->
{% set recent_activities = [
  {
    "icon": "bi bi-graph-up",
    "bg_color": "bg-warning",
    "message": "Deal progressed: <strong>GlobalTech - Moved to Negotiation</strong>",
    "time": "1 hour ago"
  },
  {
    "icon": "bi bi-person-plus",
    "bg_color": "bg-primary",
    "message": "New contact added: <strong>Sarah Johnson</strong>",
    "time": "3 hours ago"
  },
  {
    "icon": "bi bi-building-add",
    "bg_color": "bg-danger",
    "message": "New company added: <strong>Quantum Solutions</strong>",
    "time": "Yesterday"
  },
  {
    "icon": "bi bi-currency-dollar",
    "bg_color": "bg-success",
    "message": "Deal closed: <strong>Fusion Industries - $185,000</strong>",
    "time": "2 days ago"
  },
  {
    "icon": "bi bi-calendar-event",
    "bg_color": "bg-info",
    "message": "Meeting scheduled with <strong>NexGen Systems</strong>",
    "time": "March 27, 2025"
  }
] %}

{# Use the recent_activity widget with your activities #}
{{ recent_activity.recent_activity(recent_activities, "Recent Activity", "/all-activities") }}
{% endblock %}

{% block scripts_extra %}
<script src="{{ url_for('static', filename='js/components/highlights.js') }}"></script>
{% endblock %}

{% block head_extra %}
<style>
  .activity-icon {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>
{% endblock %}