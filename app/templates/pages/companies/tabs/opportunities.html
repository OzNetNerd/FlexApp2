{% import 'macros/layout.html' as layout %}
{% import 'macros/entity.html' as entity %}

{% call layout.tab_pane('opportunities') %}
  {% if opportunities and opportunities|length > 0 %}
    {{ entity.render_entity_table(
      opportunities,
      'Opportunities',
      [
        {'key': 'name', 'label': 'Name'},
        {'key': 'status', 'label': 'Status', 'type': 'badge', 'badge_mapping': {
          'New': 'bg-info',
          'Qualified': 'bg-primary',
          'Proposal': 'bg-warning',
          'Won': 'bg-success',
          'Lost': 'bg-danger'
        }},
        {'key': 'value', 'label': 'Value', 'type': 'currency'},
        {'key': 'close_date', 'label': 'Close Date'}
      ],
      '/opportunities'
    ) }}
  {% else %}
    {{ entity.render_empty_state('No opportunities linked to this company.') }}
  {% endif %}
{% endcall %}